# TaskUpdate

## التعريف

تحديث حالة أو محتوى أو علاقات التبعية لمهمة معينة في قائمة المهام.

## المعاملات

| المعامل | النوع | مطلوب | الوصف |
|---------|-------|-------|-------|
| `taskId` | string | نعم | معرف المهمة المراد تحديثها |
| `status` | enum | لا | الحالة الجديدة: `pending` / `in_progress` / `completed` / `deleted` |
| `subject` | string | لا | العنوان الجديد |
| `description` | string | لا | الوصف الجديد |
| `activeForm` | string | لا | نص بصيغة المضارع المستمر يُعرض أثناء التنفيذ |
| `owner` | string | لا | المسؤول الجديد عن المهمة (اسم agent) |
| `metadata` | object | لا | بيانات وصفية للدمج (تعيين القيمة إلى null لحذف المفتاح) |
| `addBlocks` | string[] | لا | قائمة معرفات المهام المحظورة بواسطة هذه المهمة |
| `addBlockedBy` | string[] | لا | قائمة معرفات المهام السابقة التي تحظر هذه المهمة |

## تدفق الحالات

```
pending → in_progress → completed
```

يمكن الانتقال إلى `deleted` من أي حالة، مما يزيل المهمة نهائياً.

## سيناريوهات الاستخدام

**مناسب للاستخدام:**
- تعيين المهمة كـ `in_progress` عند بدء العمل
- تعيين المهمة كـ `completed` بعد إنجاز العمل
- تعيين علاقات التبعية بين المهام
- تحديث محتوى المهمة عند تغيير المتطلبات

**قواعد مهمة:**
- لا تعيّن المهمة كـ `completed` إلا عند إنجازها بالكامل
- عند مواجهة أخطاء أو عوائق، أبقِ الحالة `in_progress`
- لا يجوز تعيين `completed` عند فشل الاختبارات أو عدم اكتمال التنفيذ أو وجود أخطاء غير محلولة

## ملاحظات

- قبل التحديث يجب الحصول على أحدث حالة للمهمة عبر TaskGet لتجنب البيانات القديمة
- بعد إكمال المهمة استدعِ TaskList للبحث عن المهمة التالية المتاحة

## الأهمية في cc-viewer

TaskUpdate هي عملية إدارة مهام داخلية، لا تنتج طلب API مستقل.
